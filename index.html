<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="utf-8" />
    <title>Электронний Цифровий Підпис</title>
</head>
<body>
    <script type="text/javascript" src="/js/uadstu.js"></script>
    <script type="text/javascript" src="/js/knockout-3.1.0.js"></script>
    <script type="text/javascript" src="/js/build.js"></script>

    <style>
    .field_error { 
        border: solid 1px red;
    }
    .error {
        color: red;
    }
    #document textarea {
        width: 75%;
        height: 65%;
    }
    </style>

    <h1>Электронная цифровая подпись</h1>

    <div id="ui" data-bind="visible: visible" style="display: none">
        <p>
            Тут можно подписать любой документ цифровой подписью, соответствующей Державному Стандарту України. Физические лица, предприниматели и юридические лица могу получить такую подпись в АЦСК Миндоходов или купить у частных центров сертификации. Согласно законов Украины, такая подпись эквивалентна автографу на бумаге и может, и уже используется, для сдачи отчетов в налоговую, проведения банковских платежей, заключения договоров и так далее.
        </p>
        <p data-bind="visible: dnd_visible" >
            Чтобы подписать документ, сбросьте файл подписи в выделенный прямоугольник. Файл подписи не будет передан на сервер.
            После этого вы сможете ввести подписываемый документ и получить контрольную сумму (хеш) и числа S, R, удостоверяющие,
            что именно вы подписали этот документ. Инструмент находится в разработке (бета).
        </p>

        <p data-bind="visible: error_visible">
            <span class="error" data-bind="visible: error_visible, text: error_text"></span>
        </p>

        <div id="drop_zone" data-bind="visible: dnd_visible, text: dnd_text" >Файл бросать сюда.</div>
        <p data-bind="visible: pw_visible">
            Файл ключа зашифрован. Введите пароль и нажмите кнопку
            <input id='pw_in' data-bind="css: {field_error: pw_error}, visible: pw_visible, value: pw" type="password" />
            <button id="pw_accept" type="button" data-bind="visible: pw_visible, click: accept_pw" >Расшифровать</button>
        </p>
        <div id="key_info" data-bind="visible: key_info_visible">
            <span data-bind="text: key_info"></span>
        </div>

        <pre id="pem_out" data-bind="text: pem_text, visible: pem_visible" ></pre>
        <div id="key_controls" data-bind="visible: key_controls_visible" >
            <button id="do_sign" data-bind="click: do_sign">Подписать документ</button>
            <!--<button id="do_save" data-bind="click: do_save">Remember key</button>-->
            <button id="as_pem" data-bind="click: show_pem">PEM</button>
        </div>
    </div>

    <div id="document" data-bind="visible: visible" style="display: none">
            <h2>Введите текст документ в поле ниже</h2>
            <textarea data-bind="document_text"></textarea>

            <p>
                <span data-bind="text: sign"></span>
            </p>

            <p>
                <button data-bind="click: do_sign">Подписать</button>
            </p>
    </div>

    <script>
        require('ui').setup();
    </script>

    <p>
    Исходный код: <a href="https://github.com/muromec/dstukeys">github.com/muromec/dstukeys</a>, Закон України <a href="http://zakon4.rada.gov.ua/laws/show/852-15">Про електронний цифровий підпис</a>, стандарт <a href="http://info-stand.com/downloads/dstu/dstu-4145-2002/dstu-4145-2002.pdf">ДСТУ-4145-2002</a>, Акредитований центр сертифікації ключів Міндоходів (<a href="http://acskidd.gov.ua/">сайт</a>), реализация ДСТУ 4145 для OpenSSL (<a href="http://www.crypto.org.ua/">сайт</a>).
    </p>
    <p>Copyright Ilya Petrov <a href="https://facebook.com/ilya.muromec">FB</a>, <i>ilya.muromec@gmail.com</i>, 2014. You can send tips to 15qmFc9MR8z8YFBqkHcSoQGGxQgVrWdn7S.</p>

    <style>
    #drop_zone {
        border: 2px dashed #bbb;
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius: 5px;
        padding: 25px;
        text-align: center;
        font: 20pt bold 'Vollkorn';
        color: #bbb;
    }
    </style>
    <script>

    </script>
</body>
